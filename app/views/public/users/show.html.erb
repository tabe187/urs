<head>
</head>

<main>
  <div class="container">
   <div class="row justify-content-center">
    <div class="col-md-3 justify-content-center text-center">

      <% if @user.profile_image.attached? %>
           <div class="flex-item">
             <div class="image-wrap">
               <%= image_tag @user.get_profile_image(100,100) %><br>
             </div>
           </div>
      <% else %>
            <div class="flex-item">
             <div class="image-wrap">
               <%= image_tag 'no_image', size: "100x100" %><br>
             </div>
           </div>
      <% end %>

       <%= @user.name %><br>

        <% if user_signed_in? && @user == current_user %>
         <%= link_to "プロフィール編集", edit_user_path(@user), class: "btn-sm btn-success" %>
        <% end %>
        
        <% if user_signed_in? && @user != current_user %>
         <% if current_user.following?(@user) %>
          <%= link_to 'フォロー外す', user_relationships_path(@user.id), method: :delete, class: "btn-sm btn-danger" %>
         <% else %>
          <%= link_to 'フォローする', user_relationships_path(@user.id), method: :POST, class: "btn-sm btn-success" %>
         <% end %>
        <% end %>
        
        <% if !user_signed_in? %>
          <%= link_to 'フォローする', new_user_session_path, class: "btn-sm btn-success" %>
        <% end %>

     <div class="row">
      <%= link_to follows_user_path(@user) do %>
       FOLLOWING(<%= @following_users.count %>)
      <% end %>
     </div>
     <div class="row">
        <% @following_users.each do |following| %>
          <div class="col border">
           <% if following.profile_image.attached? %>
             <div class="flex-item">
               <div class="image-wrap-follow">
                  <%= image_tag following.get_profile_image(100,100) %><br>
               </div>
             </div>
           <% else %>
             <div class="flex-item">
               <div class="image-wrap-follow">
                  <%= image_tag 'no_image', size: "100x100" %><br>
               </div>
             </div>
           <% end %>
           <%= link_to following.name, user_path(following.id) %>
          </div>
        <% end %>
     </div>
     <div class="row">
      <%= link_to followers_user_path(@user) do %>
       FOLLOWER(<%= @follower_users.count %>)
      <% end %>
     </div>
     <div class="row">
        <% @follower_users.each do |follower| %>
          <div class="col border">
           <% if follower.profile_image.attached? %>
             <div class="flex-item">
               <div class="image-wrap-follow">
                  <%= image_tag follower.get_profile_image(100,100) %><br>
               </div>
             </div>
           <% else %>
             <div class="flex-item">
               <div class="image-wrap-follow">
                  <%= image_tag 'no_image', size: "100x100" %><br>
               </div>
             </div>
           <% end %>
           
           <%= link_to follower.name, user_path(follower.id) %>
          </div>
        <% end %>
     </div>
     <div class="row">
       コミュニティ
     </div>
     <div class="row">
        <% @user.communities.each do |community| %>
          <div class="col border">
           <% if community.community_image.attached? %>
             <div class="flex-item">
               <div class="image-wrap-follow">
                  <%= image_tag community.get_community_image(100,100) %><br>
               </div>
             </div>
           <% else %>
             <div class="flex-item">
               <div class="image-wrap-follow">
                  <%= image_tag 'no_image', size: "100x100" %><br>
               </div>
             </div>
           <% end %>
           <%= link_to community.title, community_path(community.id) %>
          </div>
        <% end %>
     </div>
    </div>
    <div class="col-md-6 border">
     <table class="table">
      <thead>
        <tr>
         <th scope="col">プロフィール</th>
        </tr>
      </thead>
      <tbody>
        <tr>
         <th scope="col">名前</th>
         <td><%= @user.name %></td>
        </tr>
        <tr>
         <th scope="col">所在地</th>
         <td><%= @user.region + @user.city %></td>
        </tr>
        <tr>
         <th scope="col">性別</th>
         <td><%= @user.gender_i18n %></td>
        </tr>
        <tr>
         <th scope="col">生年月日</th>
         <td><%= @user.birthday_year %>年<%= @user.birthday_month%>月<%= @user.birthday_day %>日</td>
        </tr>
        <tr>
         <th scope="col">趣味</th>
         <td>
          <% if  @user.hobby %>
          　<%= @user.hobby %>
          <% end %>
         </td>
        </tr>
        <tr>
         <th scope="col">自己紹介</th>
         <td><%= @user.profile %></td>
        </tr>

      </tbody>
    </table>
    </div>

  </div>
</main>

 <div class="chat-wrapper">
   <%= link_to(rooms_path(user_ids: [current_user.id, @user.id]), method: :post) do %>
    <div class="chat-btn">
      <div class="chat-p">チャットで相談する</div>
        <%#= image_tag 'chat.png', class: 'chat-logo'%>
    </div>
   <% end %>
 </div>
